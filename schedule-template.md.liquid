{%- assign debug = false %}
<style>
.schedule .time { font-size: 75%;}
.schedule .planned {border: 1px solid black;}
.schedule .break {text-align: center; vertical-align: middle; background-color: #999;}
.schedule .openspace {text-align: center; border: 1px solid black;}
@media all {
.page-break { display: none; }

}
@media print {
.page-break { display: block; page-break-before: always; }
.site-head { display: none; }
.topnav_anchor { display: none; }
.topnav { display: none; }
.site-footer { display: none; }
.post-title { display: none; }
.schedule-grid { display: none; }
@page {size: landscape; }

}
</style>


{%- for day in schedule.calendar %}
## {{ day.label }}
<div class="schedule-grid">
<table class="{{ schedule.class-type }}">
<!-- all-day -->
{%- for event in day.all-day %}
  <tr>
    <td>{{event.label}}
    <td>{{event.start-time}}
    <td>{{event.stop-time}}
  </tr>
{%- endfor %}
</table>

<!-- hourly -->

<table class="{{ schedule.class-type }}">
    <tr>
        {%- for column in schedule.columns %}
          {%- if column.hide == true %}<!-- skip -->{%- continue %}{%- endif %}
          {%- capture width %}{%- if column.width != nil %}width="{{column.width}}"{%- endif %}{%- endcapture %}
        <th {{width}}>{{column.label}}</th>
        {%- endfor %}
    </tr>

{%- for half-hour in (0..day.hourly.half-hour-slot-count) %}
{%- assign hour = half-hour | divided_by: 2 | plus: day.hourly.start-time %}
{%- capture hour-minutes %}{%- cycle day.label: '00', '30' %}{%- endcapture %}
  <tr>
      {%- capture ampm %}{%- if hour >= 12 %}PM{%- else %}AM{%- endif %}{%- endcapture %}
      {%- capture time %}{%- if hour > 12 %}{{ hour | minus: 12 }}{%- else %} {{hour}}{%- endif %}:{{ hour-minutes }} {{ampm}}{%- endcapture %}      
    <td class="time">{{time}}

{%- for panel in day.hourly.time-slots[forloop.index0] %}
  {%- capture colspan %}{%- if panel.colspan != nil %}colspan="{{panel.colspan}}"{%- endif %}{%- endcapture %}
  {%- capture cap_id %}{% increment slot_id %}{% endcapture %}
  {%- savetime slot_id, time %}
    <td class="{{panel.class}}" rowspan="{{panel.slots}}" {{colspan}}> <a id="slot_{{cap_id}}" href="#slot_detail_{{cap_id}}">{{panel.label}}</a>
{%- endfor %}
  </tr>
{%- endfor %}
</table>
</div>
{%- endfor %}


## Panel Details
{%- for day in schedule.calendar %}
   {%- for time-slot in day.hourly.time-slots %}
      {%- for panel in time-slot %}
          {%- capture cap_id %}{% increment slot_detail_id %}{% endcapture %}
          {%- if panel.class == "openspace" %}
<div class="page-break"></div>          

### <a id="slot_detail_{{cap_id}}" href="#slot_{{cap_id}}">{{panel.label}} </a> [{{time}}]
          {%- if panel.details != %}
              {{panel.details}}
          {%- endif %}
{%- endif %}

       {%- endfor %}
   {%- endfor %}
{%- endfor %}
{{slottime}}
{{page}}
